openadds
========

```{r echo=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

[![Build Status](https://travis-ci.org/sckott/openadds.svg)](https://travis-ci.org/sckott/openadds)
[![codecov.io](https://codecov.io/github/sckott/openadds/coverage.svg?branch=master)](https://codecov.io/github/sckott/openadds?branch=master)

`openadds` is an R client for data from [Openaddresses.io](http://openaddresses.io/). Data comes from [http://data.openaddresses.io](http://data.openaddresses.io). 

The reason for creating this R client is that the data coming from OpenAddresses is heterogenous in many ways:

* File types: sometimes provided as a csv, sometimes as a Shape file
* Data fields: columns in each dataset vary. Some have no lat/long data, or if present are variously labeled `LON`/`LONGITUDE/LNG` etc., and address fields are especially variable

This pacakge tries to make it easy to retreive the data, as well as combine data sets, and visualize. 

## Install

```{r eval=FALSE}
install.packages("devtools")
devtools::install_github("rstudio/leaflet")
devtools::install_github("sckott/openadds")
```

```{r}
library("openadds")
```

## List datasets

```{r}
dat <- oa_list()
dat[2:6]
```

## Search for datasets

```{r}
oa_search(country = "us", state = "ca")
```

## Get data

Passing in a URL

```{r}
(out1 <- oa_get(dat[5]))
```

First getting URL for dataset through `as_openadd()`, then passing to `oa_get()`

```{r}
(x <- as_openadd("us", "nm", "hidalgo"))
```

```{r}
oa_get(x)
```

## Combine multiple datasets

```{r}
out2 <- oa_get(dat[32])
(alldat <- oa_combine(out1, out2))
```

## Map data

Get some data

```{r eval=FALSE}
x <- oa_get(oa_search(country = "us", city = "boulder")[1,]$url)
y <- oa_get(oa_search(country = "us", city = "gunnison")[1,]$url)
```

Make an interactive map

```{r eval=FALSE}
library("leaflet")
oa_combine(x, y) %>% 
  leaflet() %>%
  addTiles() %>%
  addCircles(lat = ~lat, lng = ~lon, popup = ~address)
```

![map1](inst/img/map.png)
